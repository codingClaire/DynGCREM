from train import gnn_embedding
from preprocessing import preprocess

args={
      "base_path": './data/graph_30000',
      "origin_folder": "1.format",
      "embed_folder": "2.embedding/EvolveGCN3",
      "model_folder": "CTGCN/model",
      "model_file": "evolvegcn",
      "node_file": "nodes_set/nodes.csv",
      "file_sep": "\t",
      "start_idx": 0,
      "end_idx": -1,
      "duration": 1,
      "embed_dim": 8,
      "has_cuda": False,
      "thread_num": 30,
      "epoch": 15,
      "lr": 1e-3,
      "batch_size": 5120,
      "load_model": False,
      "shuffle": True,
      "export": True,
      "record_time": False,
      "hid_dim": 128,
      "init_type": "one-hot",
      "std": 1e-4,
      "model_type": "EGCNH",
      "weight_decay": 5e-4,
      "learning_type": "U-neg",
      "walk_pair_folder": "CTGCN/ctgcn_walk_pairs",
      "node_freq_folder": "CTGCN/ctgcn_node_freq",
      "neg_num": 20,
      "Q": 20,
      "nlabel_folder": "nodes_label",
      "cls_file": "evolvegcn_cls",
      "cls_bias": True,
      "cls_hid_dim": 64,
      "cls_layer_num": 1,
      "cls_activate_type": "L",
      "train_ratio": 0.5,
      "val_ratio": 0.3,
      "test_ratio": 0.2,
      "weighted": True,
      "walk_time": 20,
      "walk_length": 5,
      "worker": 30
    }
#preprocess("EvolveGCN", args)
gnn_embedding("EvolveGCN", args)

'''
args={
      "base_path": './data/graph_40000',
      "origin_folder": "1.format",
      "embed_folder": "2.embedding/EvolveGCN2",
      "model_folder": "CTGCN/model",
      "model_file": "evolvegcn",
      "node_file": "nodes_set/nodes.csv",
      "file_sep": "\t",
      "start_idx": 40,
      "end_idx": -1,
      "duration": 1,
      "embed_dim": 8,
      "has_cuda": False,
      "thread_num": 30,
      "epoch": 5,
      "lr": 1e-3,
      "batch_size": 5120,
      "load_model": False,
      "shuffle": True,
      "export": True,
      "record_time": False,
      "hid_dim": 128,
      "init_type": "one-hot",
      "std": 1e-4,
      "model_type": "EGCNH",
      "weight_decay": 5e-4,
      "learning_type": "U-neg",
      "walk_pair_folder": "CTGCN/ctgcn_walk_pairs",
      "node_freq_folder": "CTGCN/ctgcn_node_freq",
      "neg_num": 20,
      "Q": 20,
      "nlabel_folder": "nodes_label",
      "cls_file": "evolvegcn_cls",
      "cls_bias": True,
      "cls_hid_dim": 64,
      "cls_layer_num": 1,
      "cls_activate_type": "L",
      "train_ratio": 0.5,
      "val_ratio": 0.3,
      "test_ratio": 0.2,
      "weighted": True,
      "walk_time": 20,
      "walk_length": 5,
      "worker": 30
    }
#preprocess("EvolveGCN", args)
gnn_embedding("EvolveGCN", args)

args={
      "base_path": './data/graph_50000',
      "origin_folder": "1.format",
      "embed_folder": "2.embedding/EvolveGCN2",
      "model_folder": "CTGCN/model",
      "model_file": "evolvegcn",
      "node_file": "nodes_set/nodes.csv",
      "file_sep": "\t",
      "start_idx": 40,
      "end_idx": -1,
      "duration": 1,
      "embed_dim": 8,
      "has_cuda": False,
      "thread_num": 30,
      "epoch": 5,
      "lr": 1e-3,
      "batch_size": 5120,
      "load_model": False,
      "shuffle": True,
      "export": True,
      "record_time": False,
      "hid_dim": 128,
      "init_type": "one-hot",
      "std": 1e-4,
      "model_type": "EGCNH",
      "weight_decay": 5e-4,
      "learning_type": "U-neg",
      "walk_pair_folder": "CTGCN/ctgcn_walk_pairs",
      "node_freq_folder": "CTGCN/ctgcn_node_freq",
      "neg_num": 20,
      "Q": 20,
      "nlabel_folder": "nodes_label",
      "cls_file": "evolvegcn_cls",
      "cls_bias": True,
      "cls_hid_dim": 64,
      "cls_layer_num": 1,
      "cls_activate_type": "L",
      "train_ratio": 0.5,
      "val_ratio": 0.3,
      "test_ratio": 0.2,
      "weighted": True,
      "walk_time": 20,
      "walk_length": 5,
      "worker": 30
    }
#preprocess("EvolveGCN", args)
gnn_embedding("EvolveGCN", args)
'''